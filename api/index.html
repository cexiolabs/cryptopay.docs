



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://cexiolabs.github.io/cryptopay.docs/api/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../images/favicon.jpg">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>REST API - CryptoPay Service API</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="darkblue" data-md-color-accent="orange">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#rest-api" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://cexiolabs.github.io/cryptopay.docs" title="CryptoPay Service API" class="md-header-nav__button md-logo">
          
            <img src="../images/logo.jpg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              CryptoPay Service API
            </span>
            <span class="md-header-nav__topic">
              
                REST API
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://cexiolabs.github.io/cryptopay.docs" title="CryptoPay Service API" class="md-nav__button md-logo">
      
        <img src="../images/logo.jpg" width="48" height="48">
      
    </a>
    CryptoPay Service API
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../terminology/" title="Terminology" class="md-nav__link">
      Terminology
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        REST API
      </label>
    
    <a href="./" title="REST API" class="md-nav__link md-nav__link--active">
      REST API
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    Authentication
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-an-api-key" class="md-nav__link">
    Generating an API Key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-key-permissions" class="md-nav__link">
    API Key Permissions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#merchant-permission" class="md-nav__link">
    Merchant permission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#order-permission" class="md-nav__link">
    Order permission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-permission" class="md-nav__link">
    View permission
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-request" class="md-nav__link">
    Creating a Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-a-message" class="md-nav__link">
    Signing a Message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-a-timestamp" class="md-nav__link">
    Selecting a Timestamp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rate-limit" class="md-nav__link">
    Rate limit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-rules" class="md-nav__link">
    General rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2time" class="md-nav__link">
    /v2/time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2merchant" class="md-nav__link">
    /v2/merchant
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-merchants" class="md-nav__link">
    List merchants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-merchant" class="md-nav__link">
    Create merchant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-merchant" class="md-nav__link">
    Update merchant
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2order" class="md-nav__link">
    /v2/order
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-orders" class="md-nav__link">
    List orders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-order" class="md-nav__link">
    Create order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch-order" class="md-nav__link">
    Fetch order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-processing" class="md-nav__link">
    Start processing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-withdrawals" class="md-nav__link">
    List withdrawals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-withdrawal" class="md-nav__link">
    Create withdrawal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch-withdrawal" class="md-nav__link">
    Fetch withdrawal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Callbacks
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Callbacks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../notifier/" title="Notifier" class="md-nav__link">
      Notifier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../events/" title="Events" class="md-nav__link">
      Events
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    Authentication
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-an-api-key" class="md-nav__link">
    Generating an API Key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-key-permissions" class="md-nav__link">
    API Key Permissions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#merchant-permission" class="md-nav__link">
    Merchant permission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#order-permission" class="md-nav__link">
    Order permission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-permission" class="md-nav__link">
    View permission
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-request" class="md-nav__link">
    Creating a Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-a-message" class="md-nav__link">
    Signing a Message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-a-timestamp" class="md-nav__link">
    Selecting a Timestamp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rate-limit" class="md-nav__link">
    Rate limit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-rules" class="md-nav__link">
    General rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2time" class="md-nav__link">
    /v2/time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2merchant" class="md-nav__link">
    /v2/merchant
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-merchants" class="md-nav__link">
    List merchants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-merchant" class="md-nav__link">
    Create merchant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-merchant" class="md-nav__link">
    Update merchant
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2order" class="md-nav__link">
    /v2/order
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-orders" class="md-nav__link">
    List orders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-order" class="md-nav__link">
    Create order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch-order" class="md-nav__link">
    Fetch order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-processing" class="md-nav__link">
    Start processing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-withdrawals" class="md-nav__link">
    List withdrawals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-withdrawal" class="md-nav__link">
    Create withdrawal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch-withdrawal" class="md-nav__link">
    Fetch withdrawal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="rest-api">REST API</h1>
<hr />
<h2 id="authentication">Authentication</h2>
<h3 id="generating-an-api-key">Generating an API Key</h3>
<p>Before being able to sign any requests, you must create an API key via the CryptoPay support. Upon creating a key you will have 3 pieces of information which you must remember:</p>
<ul>
<li><code>Key</code> - Randomly generated and provided by CryptoPay</li>
<li><code>Secret</code> - Randomly generated and provided by CryptoPay</li>
<li><code>Passphrase</code> - Provided by you to further secure your API access. CryptoPay stores the salted hash of your passphrase for verification, but cannot recover the passphrase if you forget it.</li>
</ul>
<h3 id="api-key-permissions">API Key Permissions</h3>
<p>You can restrict the functionality of API keys. Before creating the key, you must choose what permissions you would like the key to have. The permissions are:</p>
<h4 id="merchant-permission">Merchant permission</h4>
<p>Allows a key manage your sub-merchants.</p>
<h4 id="order-permission">Order permission</h4>
<p>Allows a key to enter orders, as well as retrieve order data. This includes POST <code>/order</code> and several GET endpoints.</p>
<h4 id="view-permission">View permission</h4>
<p>Allows a key read permissions. This includes most of GET endpoints.</p>
<p>Please refer to documentation below to see what API key permissions are required for a specific route.</p>
<h3 id="creating-a-request">Creating a Request</h3>
<p>All REST requests must contain the following headers:</p>
<ul>
<li><strong>CP-ACCESS-KEY</strong> The api key as a string.</li>
<li><strong>CP-ACCESS-SIGN</strong> The base64-encoded signature (see Signing a Message).</li>
<li><strong>CP-ACCESS-TIMESTAMP</strong> A timestamp for your request.</li>
<li><strong>CP-ACCESS-PASSPHRASE</strong> The passphrase you specified when creating the API key.</li>
</ul>
<p>All request bodies should have content type <strong>application/json</strong> and be valid JSON.</p>
<h3 id="signing-a-message">Signing a Message</h3>
<p>The <strong>CP-ACCESS-SIGN</strong> header is generated by creating a sha256 HMAC using the base64-decoded secret key on the prehash string <strong>timestamp</strong> + <strong>method</strong> + <strong>requestPath</strong> + <strong>body</strong> (where + represents string concatenation) and base64-encode the output. The timestamp value is the same as the <strong>CP-ACCESS-TIMESTAMP</strong> header.</p>
<p>The <strong>body</strong> is the request body string or omitted if there is no request body (typically for GET requests).</p>
<p>The <strong>method</strong> should be UPPER CASE like "GET", "POST", etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not forget to base64-decode the alphanumeric secret string (resulting in 64 bytes) before using it as the key for HMAC. Also, base64-encode the digest output before sending in the header.</p>
</div>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Bash + OpenSSL</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="nv">SECRET</span><span class="o">=</span><span class="s2">&quot;qf8qDqcEYcFQre2mgdshfdWDs29ObeW708grqMtW9I1rLY9iAl3EUn6A1HoeMSSp3XNL3qUlRJRrlo4eo7JxBw==&quot;</span>
<span class="c1">#TIMESTAMP=$(date +%s)</span>
<span class="nv">TIMESTAMP</span><span class="o">=</span><span class="m">1573753848</span>
<span class="nv">METHOD</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span>
<span class="nv">URLPATH</span><span class="o">=</span><span class="s2">&quot;/v2/order&quot;</span>
<span class="nv">BODY</span><span class="o">=</span><span class="s1">&#39;{&quot;merchantId&quot;:&quot;p8765367&quot;,&quot;feeType&quot;:&quot;MERCHANT&quot;,&quot;autoApprove&quot;:true,&quot;address&quot;:&quot;XXX--BTC-ADDRESS--XXX&quot;,&quot;instrument&quot;:&quot;BUY_CRYPTO&quot;,&quot;amount&quot;:&quot;0.0042&quot;,&quot;amountCurrency&quot;:&quot;BTC&quot;,&quot;clientOrderId&quot;:&quot;1490548887804-3111-299&quot;,&quot;clientOrderTag&quot;:&quot;some your information to be stored along the order&quot;}&#39;</span>

<span class="nv">WHAT</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">TIMESTAMP</span><span class="si">}${</span><span class="nv">METHOD</span><span class="si">}${</span><span class="nv">URLPATH</span><span class="si">}${</span><span class="nv">BODY</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nv">SECRET_KEY</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> -n <span class="s2">&quot;</span><span class="si">${</span><span class="nv">SECRET</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">|</span> base64 --decode <span class="p">|</span> hexdump -v -e <span class="s1">&#39;/1 &quot;%02x&quot;&#39;</span><span class="k">)</span>

<span class="nb">echo</span> -n <span class="s2">&quot;</span><span class="si">${</span><span class="nv">WHAT</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">|</span> openssl dgst -sha256 -mac HMAC -macopt <span class="s2">&quot;hexkey:</span><span class="nv">$SECRET_KEY</span><span class="s2">&quot;</span> <span class="p">|</span> xxd -r -p <span class="p">|</span> base64 
// Zg0U59GORi1dXCSnRfhFeOG/PKod538ij2AnwMFC5wA<span class="o">=</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">NodeJS</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="s2">&quot;qf8qDqcEYcFQre2mgdshfdWDs29ObeW708grqMtW9I1rLY9iAl3EUn6A1HoeMSSp3XNL3qUlRJRrlo4eo7JxBw==&quot;</span><span class="p">;</span>
<span class="c1">//const timestamp = Date.now() / 1000;</span>
<span class="kr">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="mi">1573753848</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">method</span> <span class="o">=</span> <span class="s2">&quot;POST&quot;</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">urlPath</span> <span class="o">=</span> <span class="s2">&quot;/v2/order&quot;</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="s1">&#39;{&quot;merchantId&quot;:&quot;p8765367&quot;,&quot;feeType&quot;:&quot;MERCHANT&quot;,&quot;autoApprove&quot;:true,&quot;address&quot;:&quot;XXX--BTC-ADDRESS--XXX&quot;,&quot;instrument&quot;:&quot;BUY_CRYPTO&quot;,&quot;amount&quot;:&quot;0.0042&quot;,&quot;amountCurrency&quot;:&quot;BTC&quot;,&quot;clientOrderId&quot;:&quot;1490548887804-3111-299&quot;,&quot;clientOrderTag&quot;:&quot;some your information to be stored along the order&quot;}&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">what</span> <span class="o">=</span> <span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="nx">urlPath</span> <span class="o">+</span> <span class="nx">body</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">secretKey</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">secret</span><span class="p">,</span> <span class="s2">&quot;base64&quot;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">hmac</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;crypto&quot;</span><span class="p">).</span><span class="nx">createHmac</span><span class="p">(</span><span class="s2">&quot;sha256&quot;</span><span class="p">,</span> <span class="nx">secretKey</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hmac</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">what</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="s2">&quot;base64&quot;</span><span class="p">));</span>
<span class="c1">// Zg0U59GORi1dXCSnRfhFeOG/PKod538ij2AnwMFC5wA=</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_2" />
<label for="__tab_1_2">PHP</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$secret</span> <span class="o">=</span> <span class="s2">&quot;qf8qDqcEYcFQre2mgdshfdWDs29ObeW708grqMtW9I1rLY9iAl3EUn6A1HoeMSSp3XNL3qUlRJRrlo4eo7JxBw==&quot;</span><span class="p">;</span>
<span class="c1">#$timestamp = time()</span>
<span class="nv">$timestamp</span> <span class="o">=</span> <span class="mi">1573753848</span><span class="p">;</span>
<span class="nv">$method</span> <span class="o">=</span> <span class="s2">&quot;POST&quot;</span><span class="p">;</span>
<span class="nv">$urlPath</span> <span class="o">=</span> <span class="s2">&quot;/v2/order&quot;</span><span class="p">;</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="s1">&#39;{&quot;merchantId&quot;:&quot;p8765367&quot;,&quot;feeType&quot;:&quot;MERCHANT&quot;,&quot;autoApprove&quot;:true,&quot;address&quot;:&quot;XXX--BTC-ADDRESS--XXX&quot;,&quot;instrument&quot;:&quot;BUY_CRYPTO&quot;,&quot;amount&quot;:&quot;0.0042&quot;,&quot;amountCurrency&quot;:&quot;BTC&quot;,&quot;clientOrderId&quot;:&quot;1490548887804-3111-299&quot;,&quot;clientOrderTag&quot;:&quot;some your information to be stored along the order&quot;}&#39;</span><span class="p">;</span>

<span class="nv">$what</span> <span class="o">=</span> <span class="nv">$timestamp</span> <span class="o">.</span> <span class="nv">$method</span> <span class="o">.</span> <span class="nv">$urlPath</span> <span class="o">.</span> <span class="nv">$body</span><span class="p">;</span>

<span class="nv">$secretKey</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$secret</span><span class="p">);</span>

<span class="k">print</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">hash_hmac</span><span class="p">(</span><span class="s2">&quot;sha256&quot;</span><span class="p">,</span> <span class="nv">$what</span><span class="p">,</span> <span class="nv">$secretKey</span><span class="p">,</span> <span class="k">true</span><span class="p">)));</span>
<span class="c1"># Zg0U59GORi1dXCSnRfhFeOG/PKod538ij2AnwMFC5wA=</span>
</pre></div></div>
</div>
<h3 id="selecting-a-timestamp">Selecting a Timestamp</h3>
<p>The <strong>CP-ACCESS-TIMESTAMP</strong> header MUST be number of seconds since Unix Epoch in UTC. Decimal values are allowed.</p>
<p>Your timestamp must be within 30 seconds of the api service time or your request will be considered expired and rejected. We recommend using the time endpoint to query for the API server time if you believe there many be time skew between your server and the API servers.</p>
<hr />
<h2 id="rate-limit">Rate limit</h2>
<p>The API server will return a 429 response (Too Many Requests) if you have spent your allowance completely.</p>
<p>TBD: what is limit?</p>
<h2 id="general-rules">General rules</h2>
<ul>
<li>All endpoints return either a JSON object or array.</li>
<li>Data is returned in ascending order. Oldest first, newest last.</li>
<li>All time and timestamp related fields are in <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>.</li>
<li>For GET endpoints, parameters must be sent as a <a href="https://en.wikipedia.org/wiki/Query_string">query string</a>.</li>
<li>For POST, PUT, and DELETE endpoints, the parameters are sent in the request body with content type <code>application/json</code>.</li>
<li>Success request codes: 2XX</li>
<li>Client's mistakes: 4XX</li>
<li>Server's errors: 5XX</li>
</ul>
<h2 id="v2time">/v2/time</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This endpoint does not require authentication.</p>
</div>
<div class="codehilite"><pre><span></span><span class="err">GET /v2/time</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;iso&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-11-16T10:57:37.209Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;epoch&quot;</span><span class="p">:</span> <span class="mf">1573901857.209</span>
<span class="p">}</span>
</pre></div>

<p>The <code>epoch</code> field represents decimal seconds since <a href="http://en.wikipedia.org/wiki/Unix_time">Unix Epoch</a></p>
<h2 id="v2merchant">/v2/merchant</h2>
<p>Merchant endpoint is available for sub-merchants management. Every request must be signed using the described authentication scheme.</p>
<h3 id="list-merchants">List merchants</h3>
<p>Returns list of sub-merchants according filter defined by parameters
<div class="codehilite"><pre><span></span><span class="err">GET /v2/merchant</span>
</pre></div></p>
<p><strong>Permission:</strong> <a href="#merchant-permission">Merchant</a> or <a href="#view-permission">View</a></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Agument</th>
<th>Type</th>
<th>Mandatory</th>
<th>Descripton</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>ENUM</td>
<td>NO</td>
<td>Active, Installing, Blocked</td>
</tr>
</tbody>
</table>
<h3 id="create-merchant">Create merchant</h3>
<p>Register a new merchant
<div class="codehilite"><pre><span></span><span class="err">POST /v2/merchant</span>
</pre></div></p>
<p><strong>Permission:</strong> <a href="#merchant-permission">Merchant</a></p>
<p><strong>Request body:</strong></p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;TBD&quot;</span><span class="p">:</span> <span class="s2">&quot;//&quot;</span>
<span class="p">}</span>
</pre></div>

<h3 id="update-merchant">Update merchant</h3>
<p>Update an existing merchant
<div class="codehilite"><pre><span></span><span class="err">PUT /v2/merchant</span>
</pre></div></p>
<p><strong>Permission:</strong> <a href="#merchant-permission">Merchant</a></p>
<p><strong>Request body:</strong></p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;TBD&quot;</span><span class="p">:</span> <span class="s2">&quot;//&quot;</span>
<span class="p">}</span>
</pre></div>

<h2 id="v2order">/v2/order</h2>
<p>Order endpoint is available for order management. Every request must be signed using the described authentication scheme.</p>
<p><strong>Order statuses:</strong></p>
<ul>
<li>NEW - Order registered and waiting for start processing</li>
<li>PENDING - Still in progress</li>
<li>ACCEPTED - Successfully completed</li>
<li>REJECTED - Failure</li>
</ul>
<p><strong>Order lifecycle:</strong></p>
<div class="mermaid">graph TD
    NEW --&gt; PENDING
    PENDING --&gt; PENDING
    PENDING --&gt; ACCEPTED
    PENDING --&gt; REJECTED</div>

<h3 id="list-orders">List orders</h3>
<p>Returns list of orders according filter defined by parameters
<div class="codehilite"><pre><span></span><span class="err">GET /v2/order</span>
</pre></div></p>
<p><strong>Permission:</strong> <a href="#order-permission">Order</a> or <a href="#view-permission">View</a></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Agument</th>
<th>Type</th>
<th>Mandatory</th>
<th>Descripton</th>
</tr>
</thead>
<tbody>
<tr>
<td>instument</td>
<td>STRING</td>
<td>NO</td>
<td>Instrument name (like: CRYPTO_BUY)</td>
</tr>
<tr>
<td>fromId</td>
<td>STRING</td>
<td>NO</td>
<td>ID to get orders from INCLUSIVE</td>
</tr>
<tr>
<td>startDate</td>
<td>ISO 8601</td>
<td>NO</td>
<td>Date to get orders from INCLUSIVE</td>
</tr>
<tr>
<td>endDate</td>
<td>ISO 8601</td>
<td>NO</td>
<td>Date to get orders until EXCLUSIVE</td>
</tr>
<tr>
<td>status</td>
<td>STRING</td>
<td>NO</td>
<td>Status: NEW, PENDING, ACCEPTED or REJECTED</td>
</tr>
<tr>
<td>limit</td>
<td>INT</td>
<td>NO</td>
<td>Default 500; max 1000</td>
</tr>
</tbody>
</table>
<h3 id="create-order">Create order</h3>
<p>Register a new order
<div class="codehilite"><pre><span></span><span class="err">POST /v2/order</span>
</pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an idempotent POST. Any duplicate request will be completed with response 
of the first request within 24 hours from  the first request. This behaviour in conclustion
with <code>clientOrderId</code> prevents potential order duplicates.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You are able to make <strong>dry-run</strong> call before creating real orders. Add header: <strong>CP-EXECUTE-MODE: dry-run</strong> when execute this method.</p>
</div>
<p><strong>Permission:</strong> <a href="#order-permission">Order</a></p>
<p><strong>Request body:</strong></p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Generic</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;clientOrderId&quot;</span><span class="p">:</span> <span class="s2">&quot;1490548887804-XA-1112-TU&quot;</span><span class="p">,</span>
  <span class="nt">&quot;clientOrderTag&quot;</span><span class="p">:</span> <span class="s2">&quot;some info to be stored along the order&quot;</span><span class="p">,</span>
  <span class="nt">&quot;instrument&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;NAME&gt;&quot;</span><span class="p">,</span>
  <span class="err">...instrument</span> <span class="err">specific</span> <span class="err">fields...</span>
<span class="p">}</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">CRYPTO_BUY (fait)</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;https://cexiolabs.github.io/cryptopay.schemas/v2/createOrder.CRYPTO_BUY.json&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderId&quot;</span><span class="p">:</span> <span class="s2">&quot;1490548887804-XA-1112-TU&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderTag&quot;</span><span class="p">:</span> <span class="s2">&quot;Buy some BTC for 150.42$&quot;</span><span class="p">,</span>
    <span class="nt">&quot;instrument&quot;</span><span class="p">:</span> <span class="s2">&quot;CRYPTO_BUY&quot;</span><span class="p">,</span>
    <span class="nt">&quot;fiatCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cryptoCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;BTC&quot;</span><span class="p">,</span>
    <span class="nt">&quot;feeModel&quot;</span><span class="p">:</span> <span class="s2">&quot;CUSTOM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;150.42&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amountCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">,</span>
    <span class="nt">&quot;autoStart&quot;</span><span class="p">:</span> <span class="kc">false</span>
<span class="p">}</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_2" />
<label for="__tab_2_2">CRYPTO_BUY (crypto)</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;https://cexiolabs.github.io/cryptopay.schemas/v2/createOrder.CRYPTO_BUY.json&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderId&quot;</span><span class="p">:</span> <span class="s2">&quot;1490548887804-XA-1112-TU&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderTag&quot;</span><span class="p">:</span> <span class="s2">&quot;Buy 0.05142111 BTC for some $&quot;</span><span class="p">,</span>
    <span class="nt">&quot;instrument&quot;</span><span class="p">:</span> <span class="s2">&quot;CRYPTO_BUY&quot;</span><span class="p">,</span>
    <span class="nt">&quot;fiatCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cryptoCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;BTC&quot;</span><span class="p">,</span>
    <span class="nt">&quot;feeModel&quot;</span><span class="p">:</span> <span class="s2">&quot;CUSTOM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;0.05142111&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amountCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;BTC&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">,</span>
    <span class="nt">&quot;autoStart&quot;</span><span class="p">:</span> <span class="kc">false</span>
<span class="p">}</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_3" />
<label for="__tab_2_3">CRYPTO_SELL (fait)</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;https://cexiolabs.github.io/cryptopay.schemas/v2/createOrder.CRYPTO_SELL.json&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderId&quot;</span><span class="p">:</span> <span class="s2">&quot;1490548887804-XA-1112-TU&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderTag&quot;</span><span class="p">:</span> <span class="s2">&quot;Sell some BTC for 150.42$&quot;</span><span class="p">,</span>
    <span class="nt">&quot;instrument&quot;</span><span class="p">:</span> <span class="s2">&quot;CRYPTO_SELL&quot;</span><span class="p">,</span>
    <span class="nt">&quot;fiatCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cryptoCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;BTC&quot;</span><span class="p">,</span>
    <span class="nt">&quot;feeModel&quot;</span><span class="p">:</span> <span class="s2">&quot;CUSTOM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;150.42&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amountCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span>
<span class="p">}</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_4" />
<label for="__tab_2_4">CRYPTO_SELL (crypto)</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;https://cexiolabs.github.io/cryptopay.schemas/v2/createOrder.CRYPTO_SELL.json&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderId&quot;</span><span class="p">:</span> <span class="s2">&quot;1490548887804-XA-1112-TU&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOrderTag&quot;</span><span class="p">:</span> <span class="s2">&quot;Sell 0.05142111 BTC for some $&quot;</span><span class="p">,</span>
    <span class="nt">&quot;instrument&quot;</span><span class="p">:</span> <span class="s2">&quot;CRYPTO_SELL&quot;</span><span class="p">,</span>
    <span class="nt">&quot;fiatCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cryptoCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;BTC&quot;</span><span class="p">,</span>
    <span class="nt">&quot;feeModel&quot;</span><span class="p">:</span> <span class="s2">&quot;CUSTOM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;0.05142111&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amountCurrency&quot;</span><span class="p">:</span> <span class="s2">&quot;BTC&quot;</span>
<span class="p">}</span>
</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instrument specific fields are described in <a href="https://github.com/cexiolabs/cryptopay.schemas">JSON schemas</a></p>
</div>
<h3 id="fetch-order">Fetch order</h3>
<p>Fetch single order by ID
<div class="codehilite"><pre><span></span><span class="err">GET /v2/order/{{orderId}}</span>
</pre></div></p>
<p><strong>Permission:</strong> <a href="#order-permission">Order</a> or <a href="#view-permission">View</a></p>
<h3 id="start-processing">Start processing</h3>
<p>This method make sense only for order with <strong>autoStart</strong> creating option equals to <code>false</code>
<div class="codehilite"><pre><span></span><span class="err">POST /v2/order/{{orderId}}/start</span>
</pre></div></p>
<p><strong>Permission:</strong> <a href="#order-permission">Order</a></p>
<p><strong>No request body</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If order already in pending state, the method will return HTTP 403</p>
</div>
<h3 id="list-withdrawals">List withdrawals</h3>
<p>This method allows to get all nformation about all withdrawal operations related to an order</p>
<div class="codehilite"><pre><span></span><span class="err">GET /v2/order/{{orderId}}/withdrawal</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method will return HTTP 405 Not allowed, if order's instument does not support withdrawal</p>
</div>
<p><strong>Permission:</strong> <a href="#order-permission">Order</a> or <a href="#view-permission">View</a></p>
<h3 id="create-withdrawal">Create withdrawal</h3>
<p>There are several cases when crypto amount holds on order balance. This method allows to make withdrawal amount to desired crypto address</p>
<div class="codehilite"><pre><span></span><span class="err">POST /v2/order/{{orderId}}/withdrawal</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method will return HTTP 405 Not allowed, if order's instument does not support withdrawal</p>
</div>
<p><strong>Permission:</strong> <a href="#order-permission">Order</a></p>
<p><strong>Request body:</strong></p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;clientOperationId&quot;</span><span class="p">:</span> <span class="s2">&quot;123498-WITHDRAWAL-554-12&quot;</span><span class="p">,</span>
    <span class="nt">&quot;clientOperationTag&quot;</span><span class="p">:</span> <span class="s2">&quot;Some info... withdrawal by user request&quot;</span><span class="p">,</span>
    <span class="nt">&quot;targetAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">,</span>
    <span class="nt">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0493421&quot;</span>
<span class="p">}</span>
</pre></div>

<h3 id="fetch-withdrawal">Fetch withdrawal</h3>
<p>This method allows to get status of a withdrawal operation.</p>
<div class="codehilite"><pre><span></span><span class="err">GET /v2/order/{{orderId}}/withdrawal/{{operationId}}</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method will return HTTP 405 Not allowed, if order's instument does not support withdrawal</p>
</div>
<p><strong>Permission:</strong> <a href="#order-permission">Order</a> or <a href="#view-permission">View</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../terminology/" title="Terminology" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Terminology
              </span>
            </div>
          </a>
        
        
          <a href="../notifier/" title="Notifier" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Notifier
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../js/mermaid.min.js"></script>
      
    
  </body>
</html>